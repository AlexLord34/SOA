# Post Service

## Назначение
Сервис отвечает за управление пользовательскими постами, комментариями и вложениями в социальной сети. Обеспечивает создание, редактирование, удаление и просмотр контента.

## Зоны ответственности
1. **Управление постами**:
   - Создание, редактирование и удаление постов
   - Валидация контента (текст, медиа)
   - Пагинация и фильтрация ленты

2. **Работа с комментариями**:
   - Добавление и удаление комментариев
   - Модерация контента (при необходимости)
   - Дерево обсуждений

3. **Медиавложения**:
   - Загрузка и хранение вложений (изображения, видео)
   - Проверка типов и размеров файлов
   - Генерация превью

## Границы сервиса

### Входящие взаимодействия:
| Источник             | Протокол      | Назначение |
|----------------------|---------------|------------|
| API Gateway          | REST/gRPC     | Основные CRUD-операции |
| Kafka (если используется) | Event Streaming | Получение событий (лайки, просмотры) |

### Исходящие взаимодействия:
| Целевой сервис       | Протокол      | Назначение |
|----------------------|---------------|------------|
| Stats Service        | Kafka Events  | Отправка метрик (просмотры, активность) |
| User Service         | gRPC          | Проверка прав доступа пользователя |

### Что НЕ входит в обязанности:
- Хранение пользовательских данных (логинов, паролей)
- Генерация аналитических отчетов
- Управление подписками и лентой (это зона User Service)
- Финальная обработка медиа (преобразование видео/изображений)

## Технологический стек
- **Язык**: Node.js/Python
- **База данных**: PostgreSQL (для постов и комментариев)
- **Интеграции**:
  - Kafka для событий
  - gRPC для проверки прав доступа
- **API**:
  POST /posts - Создание поста
  GET /posts/{id} - Получение поста
  PUT /posts/{id} - Обновление поста
  DELETE /posts/{id} - Удаление поста
  GET /posts/{id}/comments - Получение комментариев
  
## Модель данных
**Основные сущности:**

**Посты (posts):**  
․․Идентификатор (UUID)  
․․Автор (связь с User Service)  
․․Текст/контент  
․․Статус публикации  
․․Даты создания/обновления  

**Комментарии (comments):**  
․․Связь с постом  
․․Автор  
․․Текст  
․․Временные метки  

**Медиавложения (post_attachments):**  
․․Ссылка на файл  
․․Тип контента  
․․Размер  

## Особенности реализации
․․Кэширование: Redis для популярных постов  
․․Репликация: Чтение из реплик PostgreSQL  
․․Индексы: По полям user_id, created_at  
․․Миграции: Alembic (Python) или Knex.js (Node.js)  

## Требования к окружению
․․PostgreSQL 12+  
․․Node 16+ / Python 3.9+  
․․Kafka 2.8+ (для событийной модели)
